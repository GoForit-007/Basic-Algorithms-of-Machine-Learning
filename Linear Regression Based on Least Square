# 线性回归之最小二乘算法实现
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

x=np.arange(0,10,1)
y=np.arange(0,10,1)+np.random.rand(10)

# 计算最小二乘得到的权重
x=np.column_stack((x,np.ones(x.shape[0]))).T
w=np.dot(np.dot(np.linalg.inv(np.dot(x,x.T)),x),y)

y_pred=np.dot(w.T,x)

plt.figure()
plt.plot(np.arange(0,10,1),y,'r')
plt.plot(np.arange(0,10,1),y_pred,'b')
plt.show()
